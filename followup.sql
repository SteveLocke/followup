CREATE DATABASE 'msinterviewfollowup';

CREATE TABLE DEPARTMENT (ID int, NAME varchar(255));

CREATE TABLE EMPLOYEE (ID int, FIRST varchar(255), LAST varchar(255), DEP_ID int);

INSERT INTO DEPARTMENT (ID, NAME) VALUES (1, 'Finance');
INSERT INTO DEPARTMENT (ID, NAME) VALUES (2, 'Marketing');
INSERT INTO DEPARTMENT (ID, NAME) VALUES (3, 'Accounting');
INSERT INTO DEPARTMENT (ID, NAME) VALUES (4, 'Engineering');

INSERT INTO EMPLOYEE (ID, FIRST, LAST, DEP_ID) VALUES (1, 'Bob', 'Smith', 1);
INSERT INTO EMPLOYEE (ID, FIRST, LAST, DEP_ID) VALUES (2, 'Sara', 'Anderson', 1);
INSERT INTO EMPLOYEE (ID, FIRST, LAST, DEP_ID) VALUES (3, 'Tom', 'Johnson', 2);
INSERT INTO EMPLOYEE (ID, FIRST, LAST, DEP_ID) VALUES (4, 'Jerry', 'Bateman', 3);
INSERT INTO EMPLOYEE (ID, FIRST, LAST, DEP_ID) VALUES (5, 'John', 'Holloway', 2);
INSERT INTO EMPLOYEE (ID, FIRST, LAST, DEP_ID) VALUES (6, 'Jim', 'Ortiz', 3);
INSERT INTO EMPLOYEE (ID, FIRST, LAST, DEP_ID) VALUES (7, 'Karen', 'Vrana', 1);
INSERT INTO EMPLOYEE (ID, FIRST, LAST, DEP_ID) VALUES (8, 'Andy', 'Raymond', 2);
INSERT INTO EMPLOYEE (ID, FIRST, LAST, DEP_ID) VALUES (9, 'Liz', 'Seider', 1);

SELECT DEPARTMENT.NAME FROM DEPARTMENT LEFT JOIN EMPLOYEE ON DEPARTMENT.ID = EMPLOYEE.DEP_ID WHERE EMPLOYEE.ID IS NULL;

SELECT DEPARTMENT.NAME, COUNT(DEPARTMENT.NAME) AS DEPARTMENT_COUNT FROM EMPLOYEE INNER JOIN DEPARTMENT ON DEPARTMENT.ID = EMPLOYEE.DEP_ID GROUP BY DEPARTMENT.NAME ORDER BY COUNT(DEPARTMENT.NAME) DESC LIMIT 1;

